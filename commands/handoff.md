你正在结束当前项目的工作，需要为下一个 AI 会话创建全面的交接。此命令智能分析你当前会话的成就，并使用自动检测的进展和用户提供的上下文更新交接文档。

## 自动加载的项目上下文：
@docs/ai-context/HANDOFF.md
@/CLAUDE.md

## 步骤 1：处理用户参数

灵活处理参数：
- **带参数**：`$ARGUMENTS` 提供关于完成或尝试内容的用户上下文
- **不带参数**：纯粹专注于会话分析的自动检测

用户提供的上下文：$ARGUMENTS

## 步骤 2：分析当前会话成就

思考这个会话完成了什么以及如何最好地为交接捕获它。审查你最近的对话和工具使用以识别重要工作：

**自动检测以下证据：**
- **文件操作**（Write、Edit、MultiEdit 工具）- 修改了哪些文件及原因
- **新功能** - 添加或实现的功能
- **错误修复** - 解决的问题或调试尝试
- **架构更改** - 结构改进或重构
- **配置更新** - 设置、依赖或环境更改
- **文档工作** - 文档文件更新
- **未完成工作** - 未达到完成的尝试
- **遇到的阻碍** - 阻止完成的问题

**生成会话摘要：**
```
会话分析：
- 主要工作区域：[受影响的组件/域]
- 主要成就：[关键成就]
- 修改的文件：[已更改文件列表]
- 状态：[已完成/进行中/被阻止]
- 用户上下文：[如果提供了 $ARGUMENTS]
```

## 步骤 3：分析自动加载的 HANDOFF.md

分析自动加载的 `docs/ai-context/HANDOFF.md` 以了解：
- **现有部分**及其当前状态
- **相关的持续工作**可能与你的会话连接
- **结构和格式**模式以保持一致性
- **不相关内容**应该保留

## 步骤 4：确定更新策略

思考如何基于这个会话的工作最好地更新交接。基于你的会话分析和自动加载的现有交接内容，决定：

**如果当前工作与现有任务相关：**
- 用新进展更新现有部分
- 向"已完成的工作"添加成就
- 如果已解决则更新"当前状态"和"当前问题"
- 基于新状态修改"下一步"

**如果当前工作是新的/不相关的：**
- 创建带有描述性标题的新部分
- 包含会话识别的时间戳
- 遵循现有文档结构和格式

**如果工作完成了现有任务：**
- 将任务标记为已完成
- 总结最终结果
- 如果完全解决则考虑归档或移除

## 步骤 5：智能更新 HANDOFF.md

对自动加载的 HANDOFF.md 进行有针对性的更新：

### 对于新部分，包括：
```markdown
## [任务标题] - [状态]

### 当前状态
[当前状态的简要描述]

### 已完成的工作
[带有文件路径的具体成就项目列表]

### 当前问题（如适用）
[任何阻碍或未解决的问题]

### 达到 [目标] 的下一步
[继续的可操作项目]

### 需要审查的关键文件
[按类别组织的相关文件列表]

### 下一会话的上下文
[连续性的重要说明]
```

### 对于现有部分的更新：
- **添加到成就**而不重复现有内容
- **更新状态**如果进展改变了情况
- **修改当前问题**如果问题已解决或发现新问题
- **基于新进展刷新下一步**

## 步骤 6：维护文档质量

确保你的更新遵循这些指导原则：

**内容质量：**
- **具体**：包含确切的文件路径和技术细节
- **可操作**：为继续提供清晰的下一步
- **上下文化**：解释决策背后的推理
- **当前**：反映你会话后的实际状态

**格式一致性：**
- 遵循现有 markdown 结构和模式
- 使用一致的标题级别和格式
- 保持项目符号样式和组织
- 保留文档的整体结构

**信息管理：**
- **不重复**现有信息，除非正在更新它
- **保留不相关**不属于你工作的部分
- **合并**相关信息而不是分散它
- **适当归档**已完成的工作

## 步骤 7：最终验证

完成前，验证你的交接：
- **准确反映**会话中完成的工作
- **结合**自动检测的技术更改与用户提供的上下文
- **为下一个 AI 会话提供清晰方向**
- **与现有交接内容保持连续性**
- **立即可操作**对于接手工作的人

## 质量标准

**全面但简洁：**
- 包含所有相关技术细节
- 专注于可操作信息
- 避免与现有内容冗余

**维护专业交接质量：**
- 清晰的问题陈述和当前状态
- 具体的文件引用和技术上下文
- 建立在当前进展基础上的逻辑下一步
- 有助于加速下一会话的有用上下文

这种智能交接方法确保 AI 会话间的平滑连续性，同时捕获已完成工作的技术现实和用户对工作的观点。

现在分析你的会话，将其与用户上下文 "$ARGUMENTS" 结合，并相应更新交接文档。